import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.RH_Wq4ov.js";import{m as o}from"./proxy.CtWKIOJ4.js";import{C as M}from"./chevron-left.aKcX9v7o.js";import{C as $}from"./calendar.CLrY_9Yq.js";import{C as Q}from"./clock.iALahFT7.js";import{c as J}from"./createLucideIcon.CFjhCtiB.js";import{S as X}from"./shopping-bag.DlimQM-Z.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Y=J("users",K),q=()=>e.jsxs("div",{className:"absolute -z-10 inset-0 overflow-hidden opacity-70 pointer-events-none",children:[e.jsx("div",{className:"absolute top-[20%] -left-[10%] w-[40%] h-[40%] rounded-full bg-gradient-to-br from-[#D94F4F]/20 to-transparent blur-3xl"}),e.jsx("div",{className:"absolute top-[60%] -right-[10%] w-[30%] h-[30%] rounded-full bg-gradient-to-br from-[#6B8E23]/20 to-transparent blur-3xl"})]}),D=()=>e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-[#D94F4F]/30 border-t-[#D94F4F] rounded-full animate-spin"})}),C=({src:d,alt:a,className:h})=>{const[x,l]=n.useState(!1),[f,p]=n.useState(null);return n.useEffect(()=>{const m=new window.Image;m.src=d||"/api/placeholder/500/300",m.onload=()=>{p(m.src),l(!0)},m.onerror=()=>{p("/api/placeholder/500/300"),l(!0)}},[d]),e.jsxs("div",{className:"relative w-full h-full overflow-hidden",children:[!x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-[#333333]/10 z-10 w-full h-full",children:e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(D,{})})}),f&&e.jsx("img",{src:f,alt:a,className:`${h} ${x?"opacity-100":"opacity-0"} transition-opacity duration-500 w-full h-full object-cover`,onLoad:()=>l(!0)})]})},Z=()=>{const[d,a]=n.useState(0);return n.useEffect(()=>{const h=()=>{const x=document.documentElement.scrollHeight-window.innerHeight,l=window.scrollY;a(l/x)};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]),e.jsx("div",{className:"fixed top-0 left-0 w-full h-[2px] z-50",children:e.jsx(o.div,{className:"h-full bg-gradient-to-r from-[#6B8E23] via-[#6B8E23]/70 to-[#FAFAFA]",style:{scaleX:d,transformOrigin:"0%"}})})};function de({workshopId:d}){const[a,h]=n.useState(null),[x,l]=n.useState(null),[f,p]=n.useState(!0),[m,_]=n.useState([]),[N,y]=n.useState(null),[O,T]=n.useState([]),[ee,I]=n.useState([]),[b,z]=n.useState(!1),[te,j]=n.useState(!1),[v,B]=n.useState(!1),F={1:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuMuhOjpzB02MisAEvYjHQhPGucaFX54CJrUOn",2:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibu7htBM8RilvS4mGda0BVPYjrps1H5Lf6DObNF",3:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuBHsdxLPb6lrQWNcyYFdnfEzkeVHJXgoMawmD",4:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibutFnAGpualz2QAIYZWuOfsk5nxJDdbcVy1pe4",5:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibutHioByualz2QAIYZWuOfsk5nxJDdbcVy1pe4",6:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibumctXQLNrPvHGd1j2UM5sACiWEgXI6atVnYyz",7:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuuXdUT8fyXR7wfFas8jC0PIStrJ3dMb4ZeBKD",8:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuInmtowlAyO8kqw0XmJiTH3EQFBVbCG4o2UaS",9:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuEbSDr1NQ3G5DiXUHsPJjl4xCBKmyotakWeFZ",10:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibu6VjN9FHvu4jTO7gzRm3dXnqYyJGwxA5VLMkc",11:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibuabLKK2ABUdWKHfOIM621lGQbSXNs5CArhFxz",12:"https://hd51x5cptm.ufs.sh/f/lhdSxG5nEibu5F9013ZRtlECNGU1HWj4bcvBhzO65xgwroMF"};n.useEffect(()=>{W(),window.scrollTo(0,0)},[]);const W=async()=>{p(!0),y(null);try{const t=G();if(t){l(t);const[s]=await Promise.all([P(t),E(d)]);s&&(j(!0),await U(t))}else await E(d)}catch(t){console.error("Error durante la inicialización:",t),y("Error al cargar el taller. Por favor, inténtalo de nuevo más tarde.")}finally{p(!1),B(!0)}},G=()=>{const s=document.cookie.split(";").find(r=>r.trim().startsWith("auth_token="));return s?s.trim().substring(11):null},P=async t=>{try{return(await fetch("https://booking-service.mangoflower-5e37f0a4.eastus.azurecontainerapps.io/api/auth/me",{headers:{Authorization:`Bearer ${t}`}})).ok?!0:(console.error("Invalid or expired token"),k(),l(null),j(!1),!1)}catch(s){return console.error("Error verifying token:",s),!1}},k=()=>{document.cookie="auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"},U=async t=>{if(t)try{const s=await fetch("https://booking-service.mangoflower-5e37f0a4.eastus.azurecontainerapps.io/api/reservations",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok){if(s.status===401){k(),l(null),j(!1),console.log("Session expired, please log in again");return}console.log(`Error loading reservations: ${s.status}`);return}const r=await s.json();if(r&&r.reservations){I(r.reservations);const i=r.reservations.some(c=>c.workshop_id.toString()===d.toString());z(i)}}catch(s){console.error("Error loading user reservations:",s)}},L=async()=>{try{const t=await fetch("https://booking-service.mangoflower-5e37f0a4.eastus.azurecontainerapps.io/api/workshops");if(!t.ok)throw new Error(`Error: ${t.status}`);const s=await t.json();return s&&s.workshops?(T(s.workshops),s.workshops):[]}catch(t){return console.error("Error loading all workshops:",t),[]}},E=async t=>{try{let s=O;s.length===0&&(s=await L());const r=await fetch(`https://booking-service.mangoflower-5e37f0a4.eastus.azurecontainerapps.io/api/workshops/${t}`);if(!r.ok)throw r.status===404?new Error("WORKSHOP_NOT_FOUND"):new Error(`Error: ${r.status}`);const i=await r.json();if(i&&i.workshop){const c={...i.workshop,instructor:i.workshop.instructor_name,time:`${i.workshop.start_time.substring(0,5)} - ${i.workshop.end_time.substring(0,5)}`,imageUrl:F[i.workshop.id]||"/api/placeholder/500/300",availability:i.workshop.available_slots>5?"Alta disponibilidad":"Pocas plazas",stock:i.workshop.available_slots,location:"Cocina Central, Zona 10",discountedPrice:i.workshop.price,discount:0,includes:["Material didáctico","Ingredientes necesarios","Certificado de participación","Degustación de productos"],capacity:i.workshop.capacity||20};if(h(c),s.length>0){let u=[...s.filter(g=>g.category_id===i.workshop.category_id&&g.id!==i.workshop.id)];if(u.length<3){const g=s.filter(A=>A.category_id!==i.workshop.category_id&&A.id!==i.workshop.id);u=[...u,...g.slice(0,3-u.length)]}_(u.slice(0,3))}}else throw new Error("WORKSHOP_NOT_FOUND")}catch(s){if(console.error("Error al cargar los datos del taller:",s),s.message==="WORKSHOP_NOT_FOUND")y("WORKSHOP_NOT_FOUND");else throw s}},H=t=>{const s=localStorage.getItem("salsasCart");let r=s?JSON.parse(s):[];const i=r.findIndex(S=>S.id===t.id);i!==-1?r[i].quantity+=1:r.push({...t,quantity:1}),localStorage.setItem("salsasCart",JSON.stringify(r));const c=document.createElement("div");c.className="fixed top-20 right-4 bg-[#6B8E23] text-white px-4 py-3 rounded-lg shadow-lg z-50 animate-fade-in",c.textContent=`${t.name} ha sido añadido al carrito`,document.body.appendChild(c),setTimeout(()=>{c.classList.add("animate-fade-out"),setTimeout(()=>document.body.removeChild(c),500)},3e3)},w=t=>{if(!t)return"";if(t.includes("de"))return t;try{const s=new Date(t);return new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"long",day:"numeric"}).format(s)}catch{return t}},R=t=>{localStorage.setItem("selectedCategory",t),window.location.href="/workshops"};if(f||!v)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#FAFAFA]",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx(D,{}),e.jsx("p",{className:"text-[#666666] animate-pulse",children:"Cargando información del taller..."})]})});if(N&&v){const t=N==="WORKSHOP_NOT_FOUND";return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#FAFAFA] text-[#333333]",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:t?"Taller no encontrado":"Error"}),e.jsx("p",{className:"mb-6",children:t?"El taller que buscas no existe o ha sido eliminado.":"Error al cargar el taller. Por favor, inténtalo de nuevo más tarde."}),e.jsx("a",{href:"/workshops",className:"bg-[#D94F4F] text-white px-6 py-3 rounded-lg hover:bg-[#c04545] transition-colors",children:"Ver todos los talleres"})]})})}if(!a&&v)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#FAFAFA] text-[#333333]",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Taller no encontrado"}),e.jsx("p",{className:"mb-6",children:"El taller que buscas no existe o ha sido eliminado."}),e.jsx("a",{href:"/workshops",className:"bg-[#D94F4F] text-white px-6 py-3 rounded-lg hover:bg-[#c04545] transition-colors",children:"Ver todos los talleres"})]})});const V=({workshop:t,index:s})=>{const r=w(t.date),i=F[t.id]||"/api/placeholder/400/300";return e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:s*.1},whileHover:{y:-5},children:e.jsx("a",{href:`/workshopsId/${t.id}`,className:"block",children:e.jsxs("article",{className:"group relative w-full h-full overflow-hidden bg-[#FFFFFE] shadow-sm hover:shadow-md transition-all duration-300 border border-[#FFFFE3]/20",children:[e.jsxs("div",{className:"relative overflow-hidden  bg-[#333333] h-40",children:[e.jsx(C,{src:i,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(o.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,delay:.2},className:"bg-[#333333] text-[#FAFAFA] px-3 py-1 text-xs font-medium rounded-full backdrop-blur-sm",children:e.jsx("span",{className:"font-medium",children:t.modality==="presencial"?"PRESENCIAL":"VIRTUAL"})})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-[#6B8E23] font-medium tracking-wide mb-1",children:t.category_name||"Categoría"}),e.jsx("h3",{className:"text-lg text-[#333333] font-medium tracking-tight line-clamp-1 group-hover:text-[#D94F4F] transition-colors",children:t.name}),e.jsxs("p",{className:"text-sm text-[#666666] mt-1",children:["Por ",t.instructor_name]}),e.jsxs("p",{className:"text-xs text-[#666666] mt-2",children:[r," • ",t.start_time.substring(0,5)," - ",t.end_time.substring(0,5)]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3 pt-3 border-t border-[#FFFFE3]/30",children:[e.jsxs("p",{className:"text-base font-bold text-[#333333]",children:["Q",parseFloat(t.price).toFixed(2)]}),e.jsxs("span",{className:"text-xs bg-[#F5F5F5] px-2 py-1 rounded",children:[t.available_slots," disponibles"]})]})]})]})})})};return e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA] pt-14",children:[e.jsx(Z,{}),e.jsx(q,{}),e.jsxs("main",{className:"container mx-auto px-4 md:px-6 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative h-[400px] md:h-[500px] overflow-hidden  bg-[#FFF3E2]",children:[e.jsxs("a",{href:"/workshops",className:"absolute top-4 left-4 z-30 flex items-center text-[#333333] hover:text-[#D94F4F] transition-colors gap-2 bg-white/90 px-4 py-2 rounded-full shadow-md",children:[e.jsx(M,{size:18}),e.jsx("span",{className:"uppercase text-sm tracking-wide font-medium",children:"Volver"})]}),e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx(C,{src:a.imageUrl,alt:a.name,className:"w-full h-full object-cover"}),a.discount>0&&e.jsxs("div",{className:"absolute top-4 right-4 bg-[#D94F4F] text-white text-sm font-bold px-3 py-1 rounded-full",children:["-",a.discount,"% OFF"]})]})]}),e.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"flex flex-col justify-between",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(o.span,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-sm tracking-widest text-[#666666] uppercase block mb-1",children:["Taller ",a.modality==="presencial"?"Presencial":"Virtual"]}),e.jsx(o.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-3xl md:text-4xl font-bold text-[#333333]",children:a.name}),e.jsxs(o.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-[#666666] mt-2",children:["Instructor: ",e.jsx("span",{className:"text-[#333333] font-medium",children:a.instructor})]}),e.jsx(o.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.55},onClick:()=>R(a.category_id),className:"text-sm text-[#6B8E23] hover:underline mt-2 inline-flex items-center",children:e.jsxs("span",{children:["Ver más en ",a.category_name]})})]}),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:[e.jsx("span",{className:"inline-flex items-center gap-2 tracking-wide px-3 py-1 bg-[#6B8E23] w-fit text-white text-sm rounded-full",children:a.availability}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#666666]",children:[e.jsx($,{size:18,className:"text-[#D94F4F]"}),e.jsx("span",{children:w(a.date)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[#666666]",children:[e.jsx(Q,{size:18,className:"text-[#D94F4F]"}),e.jsx("span",{children:a.time})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[#666666]",children:[e.jsx(Y,{size:18,className:"text-[#D94F4F]"}),e.jsxs("span",{children:["Máximo ",a.capacity," personas"]})]})]})]}),e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"py-4 border-t border-b border-[#E5E5E5]",children:a.discount>0?e.jsxs("div",{className:"flex items-baseline space-x-3",children:[e.jsxs("span",{className:"text-xl text-[#666666] line-through",children:["GTQ ",a.price.toFixed(2)]}),e.jsxs("span",{className:"text-3xl font-medium text-[#D94F4F]",children:["GTQ ",a.discountedPrice.toFixed(2)]}),e.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-[#D94F4F]/20 text-[#D94F4F] text-sm rounded-sm",children:["-",a.discount,"%"]})]}):e.jsxs("span",{className:"text-3xl font-medium text-[#D94F4F]",children:["GTQ ",a.price.toFixed(2)]})}),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[e.jsx("h3",{className:"text-lg font-medium text-[#333333] mb-2",children:"Descripción"}),e.jsx("p",{className:"text-[#666666] leading-relaxed",children:a.description})]}),e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[e.jsx("h3",{className:"text-lg font-medium text-[#333333] mb-2",children:"Incluye"}),e.jsx("ul",{className:"list-disc pl-5 text-[#666666] space-y-1",children:a.includes.map((t,s)=>e.jsx("li",{children:t},s))})]}),e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},className:"pt-4",children:e.jsxs("button",{onClick:()=>H({id:a.id,name:a.name,price:a.discount>0?a.discountedPrice:a.price,originalPrice:a.price,discount:a.discount,imageUrl:a.imageUrl,type:"workshop",date:w(a.date),time:a.time}),disabled:a.available_slots<1||b,className:`w-full py-4 flex items-center justify-center gap-3 text-lg tracking-wide transition-all rounded-lg ${a.available_slots<1?"bg-[#E5E5E5] text-[#666666] cursor-not-allowed":b?"bg-[#6B8E23] text-white cursor-not-allowed":"bg-[#D94F4F] text-white hover:bg-[#c04545] shadow-md hover:shadow-lg"}`,children:[e.jsx(X,{size:18}),a.available_slots<1?"Agotado":b?"Ya reservado":"Reservar mi lugar"]})})]}),e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"pt-6 mt-6 border-t border-[#E5E5E5]",children:[e.jsxs("p",{className:"text-[#666666] text-sm",children:["Ubicación: ",e.jsx("span",{className:"text-[#333333]",children:a.location})]}),e.jsx("p",{className:"text-[#666666] text-sm mt-2",children:"* El pago reserva tu lugar. Cupos limitados, ¡no te lo pierdas!"})]})]})]}),m.length>0&&e.jsxs(o.section,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.6},className:"mt-16 pt-8 border-t border-[#E5E5E5]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#333333]",children:e.jsxs("span",{className:"relative",children:["Talleres relacionados",e.jsx("span",{className:"absolute -bottom-1 left-0 w-1/3 h-1 bg-[#D94F4F] rounded-full"})]})}),e.jsx("a",{href:"/workshops",className:"text-[#6B8E23] hover:text-[#6B8E23]/80 text-sm font-medium transition-colors",children:"Ver todos los talleres"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((t,s)=>e.jsx(V,{workshop:t,index:s},t.id))})]}),e.jsx(o.div,{className:"fixed bottom-5 right-5",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:1.5},children:e.jsx("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"bg-[#333333] text-white rounded-full w-12 h-12 p-3 flex items-center justify-center shadow-lg hover:bg-[#333333]/90 transition-all duration-300 hover:transform hover:translate-y-1","aria-label":"Volver arriba",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M12 19V5M5 12l7-7 7 7"})})})})]})]})}export{de as default};
